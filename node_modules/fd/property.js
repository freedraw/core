'use strict'

module.exports = function(object, name, config) {
  var data = '_' + name

  var set = config.set
  var willSet = config.willSet
  var didSet = config.didSet

  if (willSet && !set && !didSet) {
    set = function(value) {
      willSet.call(this, value)
      this[data] = value
    }
  } else if (didSet && !set && !willSet) {
    set = function(value) {
      this[data] = value
      didSet.call(this, value)
    }
  } else if (didSet && willSet && !set) {
    set = function(value) {
      willSet.call(this, value)
      this[data] = value
      didSet.call(this, value)
    }
  } else if (set && (willSet || didSet)) {
    var set2 = set
    if (!willSet) willSet = function() {}
    if (!didSet) didSet = function() {}
    set = function() {
      willSet.call(this, value)
      set2.call(this, value)
      didSet.call(this, value)
    }
  }

  var get = config.get || function() {return this[data]}

  Object.defineProperty(object, name, {
    get: get,
    set: set,
    enumerable: false,
    configurable: true,
  })
}
